"0","library(dplyr)"
"0","library(ggplot2)"
"0","library(viridis)"
"0","library(readr)"
"0","library(dplyr)"
"0","library(ggplot2)"
"0","library(stringr)"
"0",""
"0","tme <-  theme(axis.text = element_text(size = 10, color = ""black""),"
"0","              axis.title = element_text(size = 12, face = ""bold""),"
"0","              panel.grid.major = element_blank(),"
"0","              panel.grid.minor = element_blank())"
"0","theme_set(theme_bw())"
"0",""
"0","# Read the interaction data"
"0","data <- read.csv(""Interaction_data.csv"", encoding = ""latin1"", stringsAsFactors = FALSE)"
"0","metadata <- read_csv(""metadata.csv"", show_col_types = FALSE)"
"0",""
"0",""
"0","# Number of networks per each study ----- "
"0","# classify the studies "
"0","classification_col <- grep(""clasification|classification"", names(metadata), ignore.case = TRUE, value = TRUE)[1]"
"0",""
"0","metadata <- metadata %>%"
"0","  mutate(!!sym(classification_col) := str_trim(!!sym(classification_col))) %>%"
"0","  mutate(!!sym(classification_col) := case_when("
"0","    str_detect(!!sym(classification_col), ""spatial.*temporal|temporal.*spatial"") ~ ""spatial and temporal"","
"0","    !!sym(classification_col) == ""spatial"" ~ ""spatial"","
"0","    !!sym(classification_col) == ""temporal"" ~ ""temporal"","
"0","    TRUE ~ !!sym(classification_col)"
"0","  ))"
"0",""
"0",""
"0","# summary the classify the studies "
"0","study_summary <- metadata %>%"
"0","  group_by(Study_id) %>%"
"0","  summarise("
"0","    total_networks = sum(number_of_neworks, na.rm = TRUE),  # <-- סיכום כל הרשתות"
"0","    classification = case_when("
"0","      any(!!sym(classification_col) == ""spatial and temporal"") ~ ""spatial and temporal"","
"0","      any(!!sym(classification_col) == ""temporal"") ~ ""temporal"","
"0","      any(!!sym(classification_col) == ""spatial"") ~ ""spatial"","
"0","      TRUE ~ ""unknown"""
"0","    ),"
"0","    .groups = ""drop"""
"0","  ) %>%"
"0","  filter(total_networks > 0) %>%"
"0","  arrange(desc(total_networks)) %>%"
"0","  mutate(Study_id = factor(Study_id, levels = Study_id))  # keep sorted order"
"0",""
"0","# graphing the number of network per study and classify the study"
"0","ggplot(study_summary, aes(x = Study_id, y = total_networks, fill = classification)) +"
"0","  geom_col(width = 0.9) +"
"0","  geom_text(aes(label = total_networks), "
"0","            vjust = -0.5, size = 2, color = ""black"") +"
"0","  scale_fill_manual("
"0","    values = c("
"0","      ""spatial"" = ""plum4"","
"0","      ""temporal"" = ""lightblue3"","
"0","      ""spatial and temporal"" = ""lightcoral"""
"0","    ),"
"0","    name = ""Classification"""
"0","  ) +"
"0","  labs("
"0","    title = "" Number of Networks per Study"","
"0","    x = ""Study_id"","
"0","    y = ""Number of Networks"""
"0","  ) +"
"0","  theme_minimal(base_size = 12) +"
"0","  theme("
"0","    plot.title = element_text(hjust = 0.5, face = ""bold"", size = 14),"
"0","    axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, size = 8.5),"
"0","    legend.position = ""top"","
"0","    legend.title = element_text(face = ""bold""),"
"0","    panel.grid.minor.x = element_blank(),"
"0","    panel.grid.major.x = element_blank()"
"0","  ) +"
"0","  tme"
