"0",""
"0",""
"0","# Classify if temporal or Spatial -------"
"0","# classification_col <- grep(""clasification|classification"","
"0","#                            names(metadata), ignore.case = TRUE, value = TRUE)[1]"
"0","# "
"0","# if (is.na(classification_col)) {"
"0","#   stop(""Classification column not found!"")"
"0","# }"
"0","# cat(""Classification column detected:"", classification_col, ""\n"")"
"0","# "
"0","# metadata <-  metadata %>%"
"0","#   mutate(!!sym(classification_col) := str_trim(!!sym(classification_col))) %>%"
"0","#   mutate(!!sym(classification_col) := case_when("
"0","#     str_detect(!!sym(classification_col),"
"0","#                ""spatial.*temporal|temporal.*spatial"") ~ ""spatial and temporal"","
"0","#     !!sym(classification_col) == ""spatial"" ~ ""spatial"","
"0","#     !!sym(classification_col) == ""temporal"" ~ ""temporal"","
"0","#     TRUE ~ !!sym(classification_col)"
"0","#   ))"
"0",""
"0","# Count unique Study_id per classification"
"0","counts <- metadata %>%"
"0","  distinct(Study_id, !!sym(classification_col)) %>%"
"0","  count(!!sym(classification_col), name = ""n_studies"") %>%"
"0","  rename(classification = !!sym(classification_col)) %>%"
"0","  mutate(classification = factor(classification,"
"0","                                 levels = c(""spatial"", ""temporal"", ""spatial and temporal"")))"
"0",""
"0",""
"0","# Bar plot"
"0","ggplot(counts,"
"0","       aes(x = classification, y = n_studies, fill = classification)) +"
"0","  geom_col(width = 0.6, colour = ""white"") +"
"0","  geom_text(aes(label = n_studies), vjust = -0.5,"
"0","            size = 3, fontface = ""bold"") +"
"0","  scale_fill_manual(values = c(""spatial"" = ""lightblue3"","
"0","                               ""temporal"" = ""lightblue3"","
"0","                               ""spatial and temporal"" = ""lightblue3"")) +"
"0","  labs(title = ""Number of studies by spatial/temporal classification"","
"0","       x = """","
"0","       y = ""Number of studies"") +"
"0","  theme_minimal(base_size = 14) +"
"0","  theme(plot.title = element_text(hjust = 0.5, face = ""bold""),"
"0","        legend.position = ""none"")+"
"0","  tme"
