"0",""
"0","# Size of network -----"
"0",""
"0","#  Calculate pollinator, plant, and total species for each network"
"0","network_sizes <- data %>%"
"0","  dplyr::group_by(Study_id, Network_id) %>%"
"0","  dplyr::summarise("
"0","    n_pollinators = dplyr::n_distinct(Pollinator_accepted_name), "
"0","    n_plants = dplyr::n_distinct(Plant_accepted_name),           "
"0","    .groups = 'drop' "
"0","  ) %>%"
"0","  # Calculate total species for the network"
"0","  dplyr::mutate("
"0","    total_species = n_pollinators + n_plants"
"0","  )"
"0",""
"0","# Apply a threshold: Keep only networks with 20 or more species"
"0","large_networks <- network_sizes %>%"
"0","  dplyr::filter(total_species >= 20) %>%"
"0","  dplyr::arrange(desc(total_species))"
"0",""
"0",""
"0","# Plotting a box plot to show the min, max, median and quartiles for each study"
"0","ggplot(large_networks, aes(x = reorder(Study_id, -total_species, FUN = median), y = total_species)) +"
"0","  geom_boxplot() +"
"0","  geom_jitter(width = 0.1, alpha = 0.5, color = ""orange"") +"
"0","  theme_minimal() +"
"0","  labs("
"0","    title = "" Network Sizes (>= 20 species) for each Study"","
"0","    x = ""Study ID"","
"0","    y = ""Total Species (Pollinators + Plants)"""
"0","  ) +"
"0","  theme("
"0","    axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),"
"0","    plot.title = element_text(hjust = 0.5),"
"0","    panel.grid.major = element_blank(), # Remove grid lines"
"0","    panel.grid.minor = element_blank()"
"0","  ) +"
"0","  tme"
