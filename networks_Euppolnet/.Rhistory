library(dplyr)
library(ggplot2)
# Read the interaction data
data <- read.csv("Interaction_data.csv", encoding = "latin1", stringsAsFactors = FALSE)
Interaction_data <- read.csv("~/EDA/Interaction_data.csv")
View(Interaction_data)
# Read the interaction data
# data <- read.csv("Interaction_data.csv", encoding = "latin1", stringsAsFactors = FALSE)
data <- Interaction_data
# Count unique networks per study
network_counts <- data %>%
# Keep only unique study_id + network_id combinations
dplyr::distinct(Study_id, Network_id) %>%
dplyr::group_by(Study_id) %>%
dplyr::summarise(unique_networks = dplyr::n()) %>%
dplyr::arrange(desc(unique_networks))
# Create a bar plot
ggplot(network_counts, aes(x = reorder(Study_id, -unique_networks), y = unique_networks)) +
geom_bar(stat = "identity", fill = "skyblue") +
theme_minimal() +
labs(title = "Number of Unique Networks per Study",
x = "Study ID",
y = "Number of Unique Networks") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
theme(plot.title = element_text(hjust = 0.5),  # Center the title
# --- REMOVE ALL GRID LINES ---
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
View(network_counts)
# 1. Create the distribution data
# This counts how many studies have 1 network, 2 networks, etc.
network_distribution <- network_counts %>%
dplyr::group_by(unique_networks) %>%
dplyr::summarise(study_count = dplyr::n()) %>%
dplyr::arrange(unique_networks)
# Print the distribution table
print("Distribution of studies by network count:")
print(network_distribution)
# 2. Plot the distribution (Bar Chart)
# This is good for seeing the count for each specific network number
ggplot(network_distribution, aes(x = factor(unique_networks), y = study_count)) +
geom_col(fill = "steelblue") + # geom_col is the same as geom_bar(stat="identity")
theme_minimal() +
labs(title = "Distribution of Studies by Network Count",
x = "Number of Unique Networks",
y = "Number of Studies") +
theme(plot.title = element_text(hjust = 0.5))
# 3. Alternative plot (Histogram)
# This is better if you have many different network counts and want to group them into bins
ggplot(network_counts, aes(x = unique_networks)) +
geom_histogram(binwidth = 1, fill = "coral", color = "black", boundary = 0, closed = "left") +
theme_minimal() +
labs(title = "Distribution of Studies by Network Count (Histogram)",
x = "Number of Unique Networks",
y = "Number of Studies") +
theme(plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) # Clean up x-axis
# 2. Plot the distribution (Bar Chart)
# This is good for seeing the count for each specific network number
ggplot(network_distribution, aes(x = (study_count) , y = factor(unique_networks)) +
theme_minimal() +
x = "Number of Unique Networks",
# 2. Plot the distribution (Bar Chart)
# This is good for seeing the count for each specific network number
ggplot(network_distribution, aes(x = study_count, y = factor(unique_networks))) +
geom_col(fill = "steelblue") + # geom_col is the same as geom_bar(stat="identity")
theme_minimal() +
labs(title = "Distribution of Studies by Network Count",
x = "Number of Studies",           # Swapped label
y = "Number of Unique Networks") +  # Swapped label
theme(plot.title = element_text(hjust = 0.5))
# 2. Plot the distribution (Bar Chart)
# This connects the points from the distribution data
ggplot(network_distribution, aes(x = unique_networks, y = study_count)) +
geom_line(color = "darkgreen", linewidth = 1) + # 'linewidth' is the modern argument for size
geom_point(color = "darkgreen", size = 3) +
theme_minimal() +
labs(title = "Distribution of Studies by Network Count (Line Chart)",
x = "Number of Unique Networks",
y = "Number of Studies") +
theme(plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) # Clean up x-axis
# This connects the points from the distribution data
ggplot(network_distribution, aes(x = study_count, y = unique_networks)) +
geom_line(color = "darkgreen", linewidth = 1) + # 'linewidth' is the modern argument for size
geom_point(color = "darkgreen", size = 3) +
theme_minimal() +
labs(title = "Distribution of Studies by Network Count (Line Chart)",
x = "Number of Unique Networks",
y = "Number of Studies") +
theme(plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) # Clean up x-axis
# This connects the points from the distribution data
ggplot(network_distribution, aes(x = study_count, y = unique_networks)) +
geom_line(color = "darkgreen", linewidth = 1) + # 'linewidth' is the modern argument for size
geom_point(color = "darkgreen", size = 3) +
theme_minimal() +
labs(title = "Distribution of Number of Networks per Study",
x = "Number of Studies",
y = "Number of Unique Networks") +
theme(
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(), # Remove major grid lines
panel.grid.minor = element_blank()  # Remove minor grid lines
) +
# Set x-axis breaks to go from 0 to the max value, in steps of 1
scale_x_continuous(breaks = seq(0, max(network_distribution$unique_networks, na.rm = TRUE), by = 1))
# This connects the points from the distribution data
ggplot(network_distribution, aes(x = study_count, y = unique_networks)) +
geom_line(color = "darkgreen", linewidth = 1) + # 'linewidth' is the modern argument for size
geom_point(color = "darkgreen", size = 3) +
theme_minimal() +
labs(title = "Distribution of Number of Networks per Study",
x = "Number of Studies",
y = "Number of Unique Networks") +
theme(
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank() # Remove major grid lines
# panel.grid.minor = element_blank()  # Remove minor grid lines
) +
# Set x-axis breaks to go from 0 to the max value, in steps of 1
scale_x_continuous(breaks = seq(0, max(network_distribution$unique_networks, na.rm = TRUE), by = 1))
# This connects the points from the distribution data
ggplot(network_distribution, aes(x = study_count, y = unique_networks)) +
geom_line(color = "darkgreen", linewidth = 1) + # 'linewidth' is the modern argument for size
geom_point(color = "darkgreen", size = 3) +
theme_minimal() +
labs(title = "Distribution of Number of Networks per Study",
x = "Number of Studies",
y = "Number of Unique Networks") +
theme(
plot.title = element_text(hjust = 0.5),
# panel.grid.major = element_blank(), # Remove major grid lines
panel.grid.minor = element_blank()  # Remove minor grid lines
) +
# Set x-axis breaks to go from 0 to the max value, in steps of 1
scale_x_continuous(breaks = seq(0, max(network_distribution$unique_networks, na.rm = TRUE), by = 1))
# distrebution for plot_df
network_distribution_plot_df<- plot_df %>%
dplyr::group_by(unique_networks) %>%
dplyr::summarise(study_count = dplyr::n()) %>%
dplyr::arrange(unique_networks)
# remove 13_Karise only for plotting
plot_df <- network_counts %>% filter(Study_id != "13_Karise")
# distrebution for plot_df
network_distribution_plot_df<- plot_df %>%
dplyr::group_by(unique_networks) %>%
dplyr::summarise(study_count = dplyr::n()) %>%
dplyr::arrange(unique_networks)
# This connects the points from the distribution data
ggplot(network_distribution_plot_df, aes(x = study_count, y = unique_networks)) +
geom_line(color = "darkgreen", linewidth = 1) + # 'linewidth' is the modern argument for size
geom_point(color = "darkgreen", size = 3) +
theme_minimal() +
labs(title = "Distribution of Number of Networks per Study",
x = "Number of Studies",
y = "Number of Unique Networks") +
theme(
plot.title = element_text(hjust = 0.5),
# panel.grid.major = element_blank(), # Remove major grid lines
panel.grid.minor = element_blank()  # Remove minor grid lines
) +
# Set x-axis breaks to go from 0 to the max value, in steps of 1
scale_x_continuous(breaks = seq(0, max(network_distribution$unique_networks, na.rm = TRUE), by = 1))
data <- Interaction_data
# Count unique networks per study
network_counts <- data %>%
# Keep only unique study_id + network_id combinations
dplyr::distinct(Study_id, Network_id) %>%
dplyr::group_by(Study_id) %>%
dplyr::summarise(unique_networks = dplyr::n()) %>%
dplyr::arrange(desc(unique_networks))
# Create a bar plot
ggplot(network_counts, aes(x = reorder(Study_id, -unique_networks), y = unique_networks)) +
geom_bar(stat = "identity", fill = "skyblue") +
theme_minimal() +
labs(title = "Number of Unique Networks per Study",
x = "Study ID",
y = "Number of Unique Networks") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
theme(plot.title = element_text(hjust = 0.5),  # Center the title
# --- REMOVE ALL GRID LINES ---
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
# remove 13_Karise
no_large_network <- network_counts %>% filter(Study_id != "13_Karise")
ggplot(no_large_network, aes(x = reorder(Study_id, -unique_networks), y = unique_networks)) +
geom_bar(stat = "identity", fill = "#358") +
theme_minimal() +
labs(title = "Number of Unique Networks per Study (excluding 13_Karise)",
x = "Study ID",
y = "Number of Unique Networks") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
ggplot(no_large_network, aes(x = reorder(Study_id, -unique_networks), y = unique_networks)) +
geom_bar(stat = "identity", fill = "#358") +
theme_minimal() +
labs(title = "Number of Unique Networks per Study (excluding 13_Karise)",
x = "Study ID",
y = "Number of Unique Networks") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
no_large_network
rlang::last_trace()
library(dplyr)
library(ggplot2)
ggplot(no_large_network, aes(x = reorder(Study_id, -unique_networks), y = unique_networks)) +
geom_bar(stat = "identity", fill = "#358") +
theme_minimal() +
labs(title = "Number of Unique Networks per Study (excluding 13_Karise)",
x = "Study ID",
y = "Number of Unique Networks") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
ggplot(no_large_network, aes(x = reorder(Study_id, -unique_networks), y = unique_networks)) +
geom_bar(stat = "identity", fill = "#335588") +
theme_minimal() +
labs(title = "Number of Unique Networks per Study (excluding 13_Karise)",
x = "Study ID",
y = "Number of Unique Networks") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
# 1. Create the distribution data
# This counts how many studies have 1 network, 2 networks, etc.
network_distribution <- network_counts %>%
dplyr::group_by(unique_networks) %>%
dplyr::summarise(study_count = dplyr::n()) %>%
dplyr::arrange(unique_networks)
# 2. Plot the distribution (Bar Chart)
# This is good for seeing the count for each specific network number
ggplot(network_distribution, aes(x = study_count, y = factor(unique_networks))) +
geom_col(fill = "steelblue") + # geom_col is the same as geom_bar(stat="identity")
theme_minimal() +
labs(title = "Distribution of Studies by Network Count",
x = "Number of Studies",           # Swapped label
y = "Number of Unique Networks") +  # Swapped label
theme(plot.title = element_text(hjust = 0.5))
# 2. Plot the distribution (Bar Chart)
# This is good for seeing the count for each specific network number
ggplot(network_distribution, aes(x = study_count, y = factor(unique_networks))) +
geom_col(fill = "steelblue") + # geom_col is the same as geom_bar(stat="identity")
theme_minimal() +
labs(title = "Distribution of Studies by Network Count",
x = "Number of Studies",           # Swapped label
y = "Number of Unique Networks") +  # Swapped label
theme(plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(), # Remove major grid lines
panel.grid.minor = element_blank()  # Remove minor grid lines
)
# distrebution for no_large_network
network_distribution_no_large_network<- no_large_network %>%
dplyr::group_by(unique_networks) %>%
dplyr::summarise(study_count = dplyr::n()) %>%
dplyr::arrange(unique_networks)
# This connects the points from the distribution data
ggplot(network_distribution_no_large_network, aes(x = study_count, y = unique_networks)) +
geom_line(color = "darkgreen", linewidth = 1) + # 'linewidth' is the modern argument for size
geom_point(color = "darkgreen", size = 3) +
theme_minimal() +
labs(title = "Distribution of Number of Networks per Study",
x = "Number of Studies",
y = "Number of Unique Networks") +
theme(
plot.title = element_text(hjust = 0.5),
# panel.grid.major = element_blank(), # Remove major grid lines
panel.grid.minor = element_blank()  # Remove minor grid lines
) +
# Set x-axis breaks to go from 0 to the max value, in steps of 1
scale_x_continuous(breaks = seq(0, max(network_distribution$unique_networks, na.rm = TRUE), by = 1))
View(data)
# 1. Calculate pollinator, plant, and total species for EACH network
network_sizes <- data %>%
# Ensure we're using dplyr's functions
dplyr::group_by(Study_id, Network_id) %>%
dplyr::summarise(
n_pollinators = dplyr::n_distinct(Pollinator_accepted_name),
n_plants = dplyr::n_distinct(Plant_accepted_name),
.groups = 'drop' # Drop grouping for next step
) %>%
# Calculate total species for the network
dplyr::mutate(
total_species = n_pollinators + n_plants
)
# 2. Apply the threshold: Keep only networks with 20 or more species
large_networks <- network_sizes %>%
dplyr::filter(total_species >= 20) %>%
dplyr::arrange(desc(total_species))
# 3. Print the resulting table of large networks to the console
print("Networks with 20 or more total species:")
print(large_networks)
# 4. Visualize the distribution of network sizes (for large networks) per study
# We will use a boxplot to show the min, max, median, and quartiles for each study
ggplot(large_networks, aes(x = reorder(Study_id, -total_species, FUN = median), y = total_species)) +
geom_boxplot() +
# geom_jitter can be added to see individual network points
geom_jitter(width = 0.1, alpha = 0.5, color = "blue") +
theme_minimal() +
labs(
title = "Distribution of Network Sizes (>= 20 species) by Study",
x = "Study ID",
y = "Total Species (Pollinators + Plants)"
) +
theme(
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(), # Remove grid lines
panel.grid.minor = element_blank()
)
# 4. Visualize the distribution of network sizes (for large networks) per study
# We will use a boxplot to show the min, max, median, and quartiles for each study
ggplot(large_networks, aes(x = reorder(Study_id, -total_species, FUN = median), y = total_species)) +
geom_boxplot() +
# geom_jitter can be added to see individual network points
geom_jitter(width = 0.1, alpha = 0.5, color = "orange") +
theme_minimal() +
labs(
title = "Distribution of Network Sizes (>= 20 species) by Study",
x = "Study ID",
y = "Total Species (Pollinators + Plants)"
) +
theme(
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(), # Remove grid lines
panel.grid.minor = element_blank()
)
# 1. Boxplot for PLANT species count per study
ggplot(large_networks, aes(x = reorder(Study_id, -n_plants, FUN = median), y = n_plants)) +
geom_boxplot() +
geom_jitter(width = 0.1, alpha = 0.5, color = "darkgreen") +
theme_minimal() +
labs(
title = "Plant Species per Network (>= 20 total species) by Study",
x = "Study ID",
y = "Number of Plant Species"
) +
theme(
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
# 2. Boxplot for POLLINATOR species count per study
ggplot(large_networks, aes(x = reorder(Study_id, -n_pollinators, FUN = median), y = n_pollinators)) +
geom_boxplot() +
geom_jitter(width = 0.1, alpha = 0.5, color = "purple") +
theme_minimal() +
labs(
title = "Pollinator Species per Network (>= 20 total species) by Study",
x = "Study ID",
y = "Number of Pollinator Species"
) +
theme(
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
# 2. Boxplot for POLLINATOR species count per study
ggplot(large_networks, aes(x = reorder(Study_id, -n_pollinators, FUN = median), y = n_pollinators)) +
geom_boxplot() +
geom_jitter(width = 0.1, alpha = 0.5, color = "darkblue") +
theme_minimal() +
labs(
title = "Pollinator Species per Network (>= 20 total species) by Study",
x = "Study ID",
y = "Number of Pollinator Species"
) +
theme(
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
# 2. Boxplot for POLLINATOR species count per study
ggplot(large_networks, aes(x = reorder(Study_id, -n_pollinators, FUN = median), y = n_pollinators)) +
geom_boxplot() +
geom_jitter(width = 0.1, alpha = 0.5, color = "purple") +
theme_minimal() +
labs(
title = "Pollinator Species per Network (>= 20 total species) by Study",
x = "Study ID",
y = "Number of Pollinator Species"
) +
theme(
axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
View(data)
